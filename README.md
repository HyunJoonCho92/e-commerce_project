# e-commerce_project

## 개요
zerobase e-commerce project

Use : Spring, Jpa, Mysql, Redis, Docker, AWS

Goal : 셀러와 구매자 사이를 중개해 주는 커머스 서버를 구축한다.


## 회원
### 공통
- [x] 이메일을 통해서 인증번호를 통한 회원가입

### 고객
- [x] 회원 가입
- [x] 인증 (이메일)
- [x] 로그인 토큰 발행
- [x] 로그인 토큰을 통한 제어 확인(JWT, Filter를 사용해서 간략하게 )
- [x] 예치금 관리

### 셀러
- [x] 회원가입


## 주문 서버
### 셀러
- [x] 상품 등록, 수정
- [x] 상품 삭제

### 구매자
- [x] 장바구니를 위한 Redis 연동
- [ ] 상품 검색 & 상세 페이지
- [x] 장바구니에 물건 추가
- [x] 장바구니 확인
- [x] 장바구니 변경
- [ ] 주문하기
- [ ] 주문내역 이메일로 발송하기

---

## 회원가입 흐름도

1. 사용자 입력
    - 사용자로부터 이메일, 비밀번호, 이름 등의 정보를 입력받습니다.

2. 이메일 중복 확인
    - `isEmailExist` 메서드를 호출하여 이메일 중복을 확인합니다.
    - 이미 존재하면 `ALREADY_REGISTER_USER` 예외를 발생시킵니다.

3. 계정 생성
    - `signUp` 메서드를 호출하여 새로운 계정을 생성하고 저장합니다.

4. 인증 코드 생성
    - `getRandomCode` 메서드를 사용하여 랜덤 인증 코드를 생성합니다.

5. 인증 이메일 발송
    - `sendEmail` 메서드를 사용하여 인증 이메일을 발송합니다.

6. 인증 코드 저장
    - `changeCustomerValidateEmail` 메서드를 호출하여 인증 코드를 저장하고 만료 시간을 설정합니다.

7. 회원가입 성공 메시지 반환
    - "회원 가입 성공" 메시지를 반환합니다.

## 이메일 인증 흐름도

1. 사용자 인증 요청
    - 사용자가 이메일로 받은 인증 링크를 클릭합니다.

2. 이메일 및 코드 검증
    - `verifyEmail` 메서드를 호출하여 이메일과 인증 코드를 검증합니다.
    - 이미 인증된 경우 `ALREADY_VERIFY` 예외를 발생시킵니다.
    - 코드가 일치하지 않으면 `WRONG_VERIFICATION` 예외를 발생시킵니다.
    - 코드가 만료되었으면 `EXPIRE_CODE` 예외를 발생시킵니다.

3. 계정 인증 완료
    - 검증이 성공하면, 고객의 `verify` 컬럼을 `true`로 설정하여 계정을 인증합니다.

4. 인증 완료 메시지 반환
    - "인증이 완료되었습니다." 메시지를 반환합니다.

---

## 로그인 흐름도

1. 클라이언트 요청
    - 사용자로부터 이메일과 비밀번호를 입력받습니다.

2. 데이터 유효성 검사
    - 서버에서 이메일과 비밀번호의 형식을 검증합니다.

3. 사용자 조회
    - findValidCustomer 또는 findValidSeller 메서드를 호출하여 데이터베이스에서 사용자를 조회합니다.
    - 사용자가 존재하지 않으면 LOGIN_CHECK_FAIL 예외를 발생시킵니다.

4. 비밀번호 검증
    - 비밀번호가 일치하지 않으면 LOGIN_CHECK_FAIL 예외를 발생시킵니다.

5. JWT 토큰 생성
    - 비밀번호가 일치하면 createToken 메서드를 호출하여 JWT 토큰을 생성합니다.
    - 토큰에는 사용자의 이메일, ID, 사용자 유형이 포함됩니다.[]

6. 응답 전송
    - 성공 시: 생성된 JWT 토큰과 함께 "로그인 성공" 메시지를 클라이언트에 전송합니다.
    - 실패 시: 적절한 오류 메시지를 클라이언트에 전송합니다.
